#!/bin/sh
# xdg-open wrapper that forwards URLs to local machine via SSH tunnel
# Falls back to system xdg-open if tunnel socket doesn't exist

SOCK="/tmp/open-forward-${USER}.sock"

if [ -S "$SOCK" ]; then
    # Socket exists - forward to local machine
    printf '%s' "$1" | socat - UNIX-CONNECT:"$SOCK"
else
    # No tunnel - use system xdg-open
    /run/current-system/sw/bin/xdg-open "$@"
fi
